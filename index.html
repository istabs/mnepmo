<!DOCTYPE HTML>
<html>

<head>
	<title>
		MNE-PMO
	</title>

	<link rel="shortcut icon" type="image/ico" href="favicon.ico">
	<link type="text/css" rel="stylesheet"
		href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link type="text/css" rel="stylesheet" href="styles.css">
	<link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.css">

</head>

<script type="text/javascript" src="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.1.1/firebase-analytics.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/firebasejs/8.1.1/firebase-firestore.js"></script>

<script type="text/javascript" src="configuration.js"></script>
<script type="text/javascript" src="uiconfiguration.js"></script>

<script type="text/javascript">
	firebase.initializeApp(firebaseConfig);
	var ui = new firebaseui.auth.AuthUI(firebase.auth());
	ui.start('#firebaseui-auth-container', uiConfig)

	function statusFlip() {
		if (document.getElementById('loginbtn').textContent === 'Logout'){
			document.getElementById('loginbtn').textContent = 'Login';
			firebaseui.auth().signOut();
		}
	}

</script>

<script type="text/javascript">
	initApp = function () {
		firebase.auth().onAuthStateChanged(function (user) {
			document.getElementById('loader').textContent = '';
			if (user) {
				// User is signed in.
				ui.reset();
				//document.getElementById('firebaseui-auth-container').style.display = "none";
				document.getElementById('#loginbtn').textContent = 'Logout'
				var displayName = user.displayName;
				var email = user.email;
				var emailVerified = user.emailVerified;
				var photoURL = user.photoURL;
				var uid = user.uid;
				var phoneNumber = user.phoneNumber;
				var providerData = user.providerData;
				user.getIdToken().then(function (accessToken) {
					document.getElementById('sign-in-status').textContent = 'ativo';
					document.getElementById('email').textContent = email;
					document.getElementById('estado').textContent = emailVerified;
				});
			} else {
				// User is not signed in.
				document.getElementById('firebaseui-auth-container').style.display = "block";
				document.getElementById('#loginbtn').textContent = 'Login'

				document.getElementById('firebaseui-auth-container').innerHTML = "";
				document.getElementById('sign-in-status').textContent = 'inativo';
				document.getElementById('email').textContent = '---';
				document.getElementById('estado').textContent = '---';
			}
		}, function (error) {
			console.log(error);
		});
	};

	window.addEventListener('load', () => initApp());
</script>

<body>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#">MNE PMO</a>
		<ul class="nav navbar-nav">
		</ul>
		<ul class="navbar-nav ml-auto">
			<li class="nav-item">
				<a class="nav-link" href="" data-target="#myModal" data-toggle="modal">About</a>
			</li>
			<li class="nav-item">
				<a id="#loginbtn" class="nav-link" href="" data-target="#myModal" data-toggle="modal" onclick="flipStatus()"></a>
			</li>
		</ul>
	</nav>

	<div id="firebaseui-auth-container"></div>
	<p>
		<div id="loader">A carregar...</div>
	</p>
	<p>O estado de sessão é <span id="sign-in-status"></span>.</p>
	<div id="sign-in"></div>
	<p>Detalhes:</p>
	<ul>
		<li>email: <span id="email"></span></li>
		<li>estado: <span id="estado"></span></li>
	</ul>
	<pre id="account-details"></pre>
	<button onclick="location.href = 'retrieve.html';" autofocus>Continuar</button>
</body>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
	integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
</script>
<script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
	integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
</script>

</html>